#!/bin/sh

sha256sum () {
    if [[ -x `which sha256sum` ]]; then
       sha256sum $1
    else
        shasum -a 256 $1
    fi
}

show_usage_error() {
    echo "Usage: $0 <version>" >&2
    exit 1
}

project_root="$(dirname $0)/../"

if [[ "$1" != "" ]]; then
    export VER="$1"
    wget -q https://github.com/cutbox/CutBox/releases/download/${VER}/CutBox-${VER}.dmg
    if [[ -f CutBox.dmg  ]]; then
      export SHA=$(sha256sum "CutBox.dmg" | awk '{printf $1}')
      rm -f CutBox.dmg
      envsubst < templates/Cask.cutbox.template.rb > "$project_root/Casks/cutbox.rb"
    else
        echo "CutBox does not have a version: $VER"
    fi
else
    show_usage_error
fi
